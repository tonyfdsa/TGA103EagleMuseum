<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>productmeau</title>
    <!-- /teleplete -->
    <link rel="stylesheet" href="./CSS/templete.css" />
    <!-- bookstrapt -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU"
      crossorigin="anonymous"
    />

    <style>
    .card:hover {
      margin: 30px;
      float: left;
      box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);

      padding: 0 !important;
      cursor: pointer !important;
    }
    .focusbtn {
	/* box-shadow: 0px 10px 14px -7px #ff9595; */
	/* background:linear-gradient(to bottom, #7892c2 5%, #476e9e 100%); */
	background-color:transparent;
	border-radius:8px;
	display:inline-block;
	cursor:pointer;
	color:#000000;
	font-family:Arial;
	font-size:20px;
	/* font-weight:bold; */
	/* padding:13px 32px; */
	text-decoration:none;
	/* text-shadow:0px 1px 0px #283966; */
}
.focusbtn:hover {
	color: aliceblue;
	background-color:#e25c44;
}
.focusbtn:active {
	position:relative;
	top:1px;
}
.search{
  background-color: white; 
  width: 40px;
}
.search:hover{
  background-color: #efeaea;
  color: rgb(244, 97, 97);
  cursor: pointer;
}
    </style>
    
  </head>


  <body>
    <!-- head -->
    <div class="wrap">
          <div class="row d-flex" >
            <div class="col-1"  alt="大頭貼" ><img src="./img/eagleIcon.jpg" class="min_picture"></IMG></div>
            <div class="col-5">
              <h1 style="text-align: center;">Eagle Museum</h1>
            </div>
            <div class="col-6 row d-flex menu btn-group" id="meau">
                <ul class="drop-down-menu d-flex" style="justify-content: end;">
                    <li ><a href="#" class="topTag">首頁</a></li>
                    <li ><a href="exhibition.html" class="topTag">展覽</a></li>
                    <li ><a href="collectionSearch 3.0.html" class="topTag">館藏</a>
                      <ul>
                        <li class="dropMeau"><a href="collectionSearch 3.0.html">館藏資訊</a></li>
                        <li class="dropMeau"><a href="#">館藏地圖</a></li>
                      </ul>
                    </li>
                    <li ><a href="#"  class="topTag">活動</a></li>
                    <li ><a href="#"  class="topTag">商城</a>
                      <ul>
                        <li class="dropMeau"><a href="#">商品列表</a></li>
                        <li class="dropMeau"><a href="#">我的購物車</a></li>
                        <li class="dropMeau"><a href="./buyerCheck.html">訂單查詢</a></li>
                        <li class="dropMeau"><a href="#">最愛清單</a></li>
                      </ul>
                    </li>
                    <li ><a href="#"  class="topTag">會員中心</a>
                      <ul>
                        <li class="dropMeau"><a href="./memberboot.html" >會員資料</a></li>
                        <li class="dropMeau"><a href="#">訂單資料</a></li>
                        <li class="dropMeau"><a href="#">我的收藏</a></li>
                      </ul>
                    </li>
                    <li ><a href="./contactUs(bootstrap).html" class="topTag">聯絡我們</a>
                      <ul>
                          <li class="dropMeau"><a href="./trafic.html">交通資訊</a></li>
                          <li class="dropMeau"><a href="./memberJoin1.html">合作提案</a></li>
                          <li class="dropMeau"><a href="#">捐款</a></li>
                          <li class="dropMeau"><a href="#">問題回饋</a></li>
                          <li class="dropMeau"><a href="#">租借場地</a></li>
                      </ul>
                    </li>
                  </ul>
          </div>
        </div>
    </div>



     
        <!-- <div class="upperColumn" id="topcontent" >
        </div> -->
          
        <!-- </div> -->
       
       <!-- main -->
       <div class="main" style="height: 1000px">
        <div class="container-fluid">

          <div class ="row" style="background-color: rgba(244, 154, 65, 0.69); height: 50px;">
            <div class="col-1"></div>
            <div class="col-2 d-flex justify-content-center">
              <button class="focusbtn" style="margin-right: 15px; padding: 0px 10px;">關注清單</button>
              <button class="focusbtn" onclick="javascript:location.href='./prodCart.html'" style="margin-right: 15px; padding: 0px 10px;">購物車</button>
            </div>
            
            <div class="col-6"></div>
            <div class="col-3" style="position: relative; top: 25%; font-size: 2ˊpx;" ><input id="searchName" type="text"  placeholder="商品搜尋">
              <button class="search">
                <span style="font-size: 15px; ;">搜尋</span>
              </button>
            </div>
          </div>
          
          
          <div class="row">
            <!-- 測邊 -->
            <div class="col-2 silde"></div>
            <!-- 主頁 -->
            <div class="col-10 row product">            
              <div style="font-size: 20px;">商品列表</div>
              
            </div>
          </div>
        </div>
       </div>

       <!-- footer -->
       <div class="footer"></div>

  <!-- jQuery 位置 -->
  <script src="./vendor/js/jquery3.6.0.js"></script>
  <!-- 模板js匯入 位置 -->
  <!-- <script src="./workJS/Template .js"></script> -->
  <!-- icon -->
  <script src="https://code.iconify.design/iconify-icon/1.0.0-beta.3/iconify-icon.min.js"></script>
  <script>
     //我的最愛
  $(".like").click(function(){
      if($(".like iconify-icon").attr("icon") == "emojione:round-pushpin"){
          $(".like iconify-icon").attr("icon","noto:round-pushpin")
      }
      else{
          $(".like iconify-icon").attr("icon","emojione:round-pushpin")
      }
  })

  //取得上架商品資訊和圖片資訊
  fetch('http://localhost:8080/TGA103eagleMuseum/ProdGetListed')
  .then(resp => resp.json())
  .then(Data => {
            console.log(Data)
            for (let i = 0 ; i< Data.result.length; i++){
              let text=
              `
              <div class="card " id="${Data.result[i].productID}" style="padding: 0%;margin: 0.5% 0.5%; width: 16rem;" >

                  <div class="card-body" >
                    <h5 class="prodName" style="align-items:center">${Data.result[i].prodName}
                      
                    </h5>
                    <p class="prodtext">商品說明</p>
                    <span class="prodPrice"><span>NT$</span>${Data.result[i].prodPrice}</span>
    
                    <span  style="float: right;"  >
                      <svg  class="shoopingCart" data-id = ${Data.result[i].productID} xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="30" height="30">
                        <path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2s-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2s2-.9 2-2s-.9-2-2-2zm-8.9-5h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.41 4l-3.86 7H8.53L4.27 2H1v2h2l3.6 7.59l-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2z" fill="currentColor"></path>
                      </svg>
                    </span>

                  </div>
                </div>
              `
              $(".product").append(text)
            }
          });
          
// 取得所有商品圖片資訊
  fetch('http://localhost:8080/TGA103eagleMuseum/ProdImgGetAll')
    .then(resp => resp.json())
    .then(Data => {
      console.log(Data)
      for(let i = 0 ; i < Data.result.length; i++){
        console.log($(".card").find(".prodImg").length) 
        if($(".card").find(`.${Data.result[i].productID}`).length == 0){
          let text=
              `
              <img src=${Data.result[i].productimg} class="${Data.result[i].productID} img" data-id="${Data.result[i].productID}" >
              `
          $(`#${Data.result[i].productID}`).prepend(text);
        }
      }
             
    })


    //搜尋by名稱
    $(document).on("click",".search",function(){
            let prodName = document.querySelector("#searchName").value
            let prodserchname = 'http://localhost:8080/TGA103_EagleMuseum/ProductGetName'
            fetch('http://localhost:8080/TGA103eagleMuseum/ProductGetName', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                  prodName
                })
              })
              .then(resp => resp.json())
              .then(Data => {
                console.log(Data)
                $(".product").find(".card").remove();
                for (let i = 0 ; i< Data.result.length; i++){
                  let text=
                  `
                  <div class="card " id="${Data.result[i].productID}" style="padding: 0%;margin: 0.5% 0.5%; width: 16rem;" >

                      <div class="card-body" >
                        <h5 class="prodName" style="align-items:center">${Data.result[i].prodName}
                          
                        </h5>
                        <p class="prodtext">商品說明</p>
                        <span class="prodPrice"><span>NT$</span>${Data.result[i].prodPrice}</span>
        
                        <span  style="float: right;"  >
                          <svg class="shoopingCart" data-id = ${Data.result[i].productID} xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="30" height="30">
                            <path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2s-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2s2-.9 2-2s-.9-2-2-2zm-8.9-5h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.41 4l-3.86 7H8.53L4.27 2H1v2h2l3.6 7.59l-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2z" fill="currentColor"></path>
                          </svg>
                        </span>

                      </div>
                    </div>
                  `
                  $(".product").append(text)
                }



                //圖片
              })
              fetch('http://localhost:8080/TGA103eagleMuseum/ProdImgGetAll')
              .then(resp => resp.json())
              .then(Data => {
                console.log(Data)
                for(let i = 0 ; i < Data.result.length; i++){
                  console.log($(".card").find(".prodImg").length) 
                  if($(".card").find(`.${Data.result[i].productID}`).length == 0){
                    let text=
                        `
                        <img src=${Data.result[i].productimg} class="img ${Data.result[i].productID}" data-id="${Data.result[i].productID}">
                        `
                    $(`#${Data.result[i].productID}`).prepend(text);
                  }
                }
                      
              })
          });
    
          //加入購物車
          $(document).on("click",".shoopingCart",function(){

            // console.log("123")
            let URL = "http://localhost:8080/TGA103eagleMuseum/ProdShoppingCart"
            let productID = $(this).attr("data-id");
            let prodImg = $(this).closest(".card").find("img").attr("src")
            // console.log(prodImg)
            // console.log(productID)
            fetch(URL, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              productID,
              prodImg
              })
            })
            .then(resp => resp.json())
            .then(Data => {  
              console.log(Data);
              alert("已加入購物車")
            })
          })

        //點擊圖片跳轉到商品頁面
        $(document).on("click",".img",function(){
          let prodID = $(this).attr("data-id")
          // console.log(prodID)
          sessionStorage.setItem("prodID", prodID)
          console.log(sessionStorage.getItem("prodID"))
          location.href = "./product.html"
        })

          
  </script>
  </body>
</html>
